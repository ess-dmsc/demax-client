<div *ngIf="!isEditing && !isEditingPassword">
	<h4>Registered users: {{users.length}}</h4>
	<table mat-table [dataSource]="users">
		<ng-container matColumnDef="firstName">
			<th mat-header-cell *matHeaderCellDef>First name</th>
			<td mat-cell *matCellDef="let user"> {{user.firstName}}</td>
		</ng-container>

		<ng-container matColumnDef="lastName">
			<th mat-header-cell *matHeaderCellDef>Last name</th>
			<td mat-cell *matCellDef="let user"> {{user.lastName}}</td>
		</ng-container>
		<ng-container matColumnDef="phone">
			<th mat-header-cell *matHeaderCellDef>Phone</th>
			<td mat-cell *matCellDef="let user"> {{user.phone}}</td>
		</ng-container>


		<ng-container matColumnDef="email">
			<th mat-header-cell *matHeaderCellDef>Email</th>
			<td mat-cell *matCellDef="let user"> {{user.email}}</td>
		</ng-container>
		<ng-container matColumnDef="role">
			<th mat-header-cell *matHeaderCellDef>Role</th>
			<td mat-cell *matCellDef="let user"> {{user.role}}</td>
		</ng-container>

		<ng-container matColumnDef="options">
			<th mat-header-cell *matHeaderCellDef> Options</th>
			<td mat-cell *matCellDef="let user">
				<button class="btn btn-sm btn-success" (click)="enablePasswordEditing(user)">Change password</button>

				<button class="btn btn-sm btn-primary" (click)="enableEditing(user)">Edit</button>

				<button class="btn btn-sm btn-danger" (click)="deleteUser(user.email)">Delete</button>
			</td>
		</ng-container>
		<tr mat-header-row *matHeaderRowDef="displayedUserColumns"></tr>
		<tr mat-row *matRowDef="let row; columns: displayedUserColumns;"></tr>
	</table>
</div>
<mat-card *ngIf="isEditingPassword" style="width: 50%; padding: 2rem; margin: 2rem auto;">
	<mat-card-title>
		Change password for {{user.email}}
	</mat-card-title>
	<form (ngSubmit)="editPassword(user)" *ngIf="isEditingPassword">
		<mat-card-content>
			<mat-form-field>
				<input matInput name="password" [(ngModel)]="user.password" placeholder="New password">
			</mat-form-field>
		</mat-card-content>
		<mat-card-actions>
			<button class="btn btn-primary" (click)="editPassword(user)">Update password</button>
			<button class="btnbtn-danger" (click)="cancelPasswordEditing()">Cancel</button>
		</mat-card-actions>
	</form>
</mat-card>

<mat-card *ngIf="isEditing" style="width: 50%; padding: 2rem; margin: 2rem auto">
	<mat-card-title>Editing user {{user.email}}</mat-card-title>
	<form #form="ngForm" (ngSubmit)="editUser(user)" *ngIf="isEditing">
		<mat-card-content>

			<mat-form-field>
				<input matInput [(ngModel)]="user.email" name="user.email" placeholder="Email">
			</mat-form-field>
			<br>
			<mat-select [(ngModel)]="user.role" name="user.role" style="width: 50%;">
				<mat-option value="user">User</mat-option>
				<mat-option value="admin">Admin</mat-option>
			</mat-select>
			<br>
		</mat-card-content>
		<mat-card-actions>
			<button class="btn btn-primary" type="submit">Save</button>
			<button class="btn btn-danger" (click)="cancelEditing()">Cancel</button>
		</mat-card-actions>
	</form>

</mat-card>