<div class="jumbotron jumbotron-fluid" *ngIf="!hasReadTos">

	<h2>Create a new proposal</h2>

	<hr class="my-4">

	<p>Users are strongly encouraged to contact DEMAX staff prior to preparing and submitting a
		deuteration/crystallization proposal. </p>
	<p>General enquiries can be sent to: <a href="mailto:demax@esss.se">demax@esss.se</a> or to one of the<a
			routerLink="/contact"> subject matter experts.</a></p>
	<p class="lead">
		<a style="margin: 1rem; " mat-raised-button class="btn btn-success btn-lg" download
		   href="{{url}}/word/attachment">
			<img style="margin-right: 1rem;" src="../../assets/logos/Microsoft_Word_logo.png" width=50
			     alt="Proposal template">
			<mat-icon>get_app</mat-icon>
	<p style="display: inline; margin: 0; padding: 0; font-size: 1.5rem;">
		DEMAX_proposal_template.docx</p>
	</a>
	</p>
	<ul>
		<li>
			Proposals should be written in English, properly referenced, and prepared in the
			<a download href="{{url}}/word/attachment">Word template</a>.
			Please keep to the 2 page limit, including Summary, Background (Science Case, Practical
			Consideration, References, Figures/Tables)
		</li>
		<li>Access to DEMAX is granted on the basis of both a technical and a peer-review process.</li>
		<li> Proposals awarded during initial operations (2019-2022) will be free of charge.
			During formal user operations (beyond 2023) we reserve the right to ask for partial financial contributions
			towards consumables & shipping costs.
		</li>

		<li> During initial operations we will not limit access to DEMAX based on ESS-membership.
			Beyond this period we will respect the user access policy that will be applicable ESS-wide.
		</li>

		<li> Biological and chemical deuteration proposals are run as a service but users for protein
			crystallization are welcome to come in person as well.
		</li>

		<li>Proposals awarded during initial operations (2019-2021) will be free of charge. During formal
			user operations (beyond 2023) we reserve the right to ask for partial financial contributions
			towards consumables & shipping costs.
		</li>

		<li class="str">
			<em>
				Users should note that the contributions by DEMAX should be acknowledged in any publications
				containing materials obtained from us. For particularly challenging projects that require above
				average involvement from DEMAX, relevant DEMAX staff should be acknowledged through
				co-authorship of any subsequent publications.
			</em>
		</li>

	</ul>
	<mat-checkbox style="margin: 2rem;">I acknowledge the information above</mat-checkbox>
	<button class="btn btn-primary btn-lg" (click)="confirm()">Accept</button>


</div>

<form [formGroup]="proposalForm" *ngIf="hasReadTos">

	<mat-card>

		<h3>General Information</h3>

		<mat-form-field>
			<input matInput
			       required
			       formControlName="experimentTitle"
			       placeholder="Proposal title">
		</mat-form-field>

		<mat-form-field>
					<textarea matInput required
					          formControlName="briefSummary"
					          placeholder="Brief summary"
					          rows="4" cols="40"></textarea>
		</mat-form-field>

		<h4>Main proposer</h4>

		<div formGroupName="mainProposer">
			<mat-form-field class="smallFormField">
				<input matInput
				       formControlName="firstName"
				       placeholder="First name">
			</mat-form-field>
			<mat-form-field class="smallFormField">
				<input matInput
				       formControlName="lastName"
				       placeholder="Last name">
			</mat-form-field>
			<br>
			<mat-form-field class="smallFormField">
				<input matInput
				       formControlName="email"
				       placeholder="Email">
			</mat-form-field>
			<mat-form-field class="smallFormField">
				<input matInput
				       formControlName="phone"
				       placeholder="Phone">
			</mat-form-field>

			<p>Affiliation</p>
			<div>
				<mat-form-field class="smallFormField">
					<input matInput
					       formControlName="jobTitle"
					       placeholder="Job title">
				</mat-form-field>
				<mat-form-field class="smallFormField">
					<input matInput
					       formControlName="employer"
					       placeholder="Employer">
				</mat-form-field>
				<mat-form-field>
					<input matInput
					       formControlName="industry"
					       placeholder="Industry">
				</mat-form-field>
			</div>
		</div>

		<div formArrayName="coProposers">
			<h4>Co-proposers</h4>
			<tr *ngFor="let coProposer of coProposerForms.controls; let i=index" [formGroupName]="i">
				<td>
					<mat-form-field class="smallFormField">
						<input matInput required formControlName="firstName" placeholder="First name">
					</mat-form-field>

					<mat-form-field class="smallFormField">
						<input matInput required formControlName="lastName" placeholder="Last name">
					</mat-form-field>
					<br>
					<mat-form-field class="smallFormField">
						<input matInput required formControlName="affiliation" placeholder="Affiliation">
					</mat-form-field>

					<mat-form-field class="smallFormField">
						<input matInput required formControlName="email" placeholder="Email">
					</mat-form-field>
				</td>
				<td>
					<button mat-icon-button color="warn"
					        (click)="deleteCoProposer(i)">
						<mat-icon>delete</mat-icon>
					</button>
				</td>
			</tr>

			<button mat-raised-button color="primary" (click)="addCoProposer()">
				<mat-icon>person_add</mat-icon>
				Click to add co-proposer
			</button>

		</div>

		<mat-action-row>
			<a class="btn btn-danger btn-lg" routerLink="/home">
				<mat-icon>cross</mat-icon>
				Cancel
			</a>
			<button class="btn btn-success btn-lg" (click)="addProposal()">
				<mat-icon>save</mat-icon>
				Save
			</button>
		</mat-action-row>
		<app-message [message]="message.message"></app-message>
	</mat-card>

</form>
